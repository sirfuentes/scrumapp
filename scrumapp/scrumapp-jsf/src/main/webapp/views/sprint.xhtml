<ui:composition template="/WEB-INF/templates/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui">

    <ui:define name="body">
        <h:form id="form">
        
        <script type="text/javascript">
		    function handleDrop(event, ui) {
		        var droppedProduct = ui.draggable;
		
		        droppedProduct.fadeOut('fast');
		    }
		</script>
            <p:growl id="msgs" showDetail="true" skipDetailIfEqualsSummary="true"/>
            	<h2>Sprint 1</h2>
				<p:panelGrid id="container" columns="4" layout="grid" 
                 style="border: 0px;" >
                 
                 
                 <p:dataView id="historiasUsuarioToDo" var="historia" value="#{sprintController.historiasUsuarioToDo}" rows="1" layout="grid" gridIcon="pi pi-th-large" >
		            <f:facet name="header">
			            To Do
			        </f:facet>
		            <p:dataViewGridItem>
		                <p:panel id="pnl1" header="#{historia.nombre}" style="text-align:center" styleClass="pnl1">
		                    <h:panelGrid columns="1" style="width:100%">
		                        <h:outputText value="#{historia.descripcion}"/>
		                        <h:outputText value="#{historia.estado}"/>
		                        <h:outputText value="#{historia.prioridad}"/>
		                        <h:outputText value="#{historia.esfuerzo}"/>
		                    </h:panelGrid>
		                </p:panel>
		
		                <p:draggable for="pnl1" revert="true" stack=".ui-panel"/>
		            </p:dataViewGridItem>
	        	</p:dataView>
	        	
	        	<p:dataView id="historiasUsuarioDoing" var="hist" value="#{sprintController.historiasUsuarioDoing}" rows="1" layout="grid" gridIcon="pi pi-th-large" >
		            <f:facet name="header">
			            Doing
			        </f:facet>
		            <p:dataViewGridItem>
		                <p:panel id="pnl2" header="#{hist.nombre}" style="text-align:center" styleClass="pnl2">
		                    <h:panelGrid columns="1" style="width:100%">
		                        <h:outputText value="#{hist.descripcion}"/>
		                        <h:outputText value="#{hist.estado}"/>
		                        <h:outputText value="#{hist.prioridad}"/>
		                        <h:outputText value="#{hist.esfuerzo}"/>
		                    </h:panelGrid>
		                </p:panel>
		
		                <p:draggable for="pnl2" revert="true" handle=".ui-panel-titlebar" stack=".ui-panel"/>
		            </p:dataViewGridItem>
	        	</p:dataView>
	        	
	        	<p:dataView id="historiasUsuarioTesting" var="historia" value="#{sprintController.historiasUsuarioTesting}" rows="1" layout="grid" gridIcon="pi pi-th-large" >
		            <f:facet name="header">
			            Testing
			        </f:facet>
		            <p:dataViewGridItem>
		                <p:panel id="pnl3" header="#{historia.nombre}" style="text-align:center" styleClass="pnl3">
		                    <h:panelGrid columns="1" style="width:100%">
		                        <h:outputText value="#{historia.descripcion}"/>
		                        <h:outputText value="#{historia.estado}"/>
		                        <h:outputText value="#{historia.prioridad}"/>
		                        <h:outputText value="#{historia.esfuerzo}"/>
		                    </h:panelGrid>
		                </p:panel>
		
		                <p:draggable for="pnl3" revert="true" handle=".ui-panel-titlebar" stack=".ui-panel"/>
		            </p:dataViewGridItem>
	        	</p:dataView>
	        	
	        	<p:dataView id="historiasUsuarioCompleted" var="historia" value="#{sprintController.historiasUsuarioCompleted}" rows="1" layout="grid" gridIcon="pi pi-th-large" >
		            <f:facet name="header">
			            Completed
			        </f:facet>
		            <p:dataViewGridItem>
		                <p:panel id="pnl4" header="#{historia.nombre}" style="text-align:center" styleClass="pnl4">
		                    <h:panelGrid columns="1" style="width:100%">
		                        <h:outputText value="#{historia.descripcion}"/>
		                        <h:outputText value="#{historia.estado}"/>
		                        <h:outputText value="#{historia.prioridad}"/>
		                        <h:outputText value="#{historia.esfuerzo}"/>
		                    </h:panelGrid>
		                </p:panel>
		
		                <p:draggable for="pnl4" revert="true" handle=".ui-panel-titlebar" stack=".ui-panel"/>
		            </p:dataViewGridItem>
	        	</p:dataView>
				
				
	        	
	        	 <p:droppable for="historiasUsuarioToDo" tolerance="pointer" activeStyleClass="ui-state-highlight"
		                     datasource="historiasUsuarioDoing" accept=".pnl2">
		            <p:ajax listener="#{sprintController.historiaToDo}" update="@form"/>
		        </p:droppable> 
	        	
                <p:droppable for="historiasUsuarioDoing" tolerance="pointer" activeStyleClass="ui-state-highlight"
		                     datasource="historiasUsuarioToDo" accept=".pnl1">
		            <p:ajax listener="#{sprintController.historiaToDoing}" update="@form"/>
		        </p:droppable>   
		        
		        <p:droppable for="historiasUsuarioTesting" tolerance="pointer" activeStyleClass="ui-state-highlight"
		                     datasource="historiasUsuarioDoing" accept=".pnl2">
		            <p:ajax listener="#{sprintController.historiaToTesting}" update="@form"/>
		        </p:droppable>    

		        
		        <p:droppable for="historiasUsuarioCompleted" tolerance="pointer" activeStyleClass="ui-state-highlight"
		                     datasource="historiasUsuarioTesting" accept=".pnl3">
		            <p:ajax listener="#{sprintController.historiaToCompleted}" update="@form"/>
		        </p:droppable>          
                
                </p:panelGrid>
                <p:ajaxExceptionHandler type="javax.faces.model.NoRowAvailableException"
                                update="@form" onexception="PF('exceptionDialog').show()"/>
                <p:dialog id="exceptionDialog" header="Exception occured!"
		                  widgetVar="exceptionDialog"
		                  height="500px">
		            Error <br/>
		            No permitido <h:outputText value="Movimiento no permitido" escape="false"/> <br/>
		
		            
		        </p:dialog>

        </h:form>
    </ui:define>

</ui:composition>