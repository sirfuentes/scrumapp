<ui:composition template="/WEB-INF/templates/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui">

    <ui:define name="body">
        <h:form id="form">
            <p:growl id="msgs" showDetail="true" skipDetailIfEqualsSummary="true"/>
            	
				<p:panelGrid id="container" columns="1" layout="grid" 
                 style="border: 0px;" >
                 <h2>Mis Proyectos</h2>
                <p:dataTable id="proyectos" widgetVar="proyectos" var="proyecto" value="#{proyectoController.proyectos}"
                      reflow="true" selection="#{proyectoController.proyectosSeleccionados}" rowKey="#{proyecto.id}" paginator="true"
                     rows="10" rowSelectMode="add" paginatorPosition="bottom">
                     
                     <f:facet name="header">
		                <p:outputPanel style="text-align: right;">

			                    <p:outputLabel >
			                        <i class="fa fa-search"></i>
			                        <p:inputText id="globalFilter" onkeyup="PF('dtProducts').filter()" placeholder="Search"  style="margin-left:5px"/>
			                    </p:outputLabel>

		                </p:outputPanel>
		            </f:facet>
		            
		            <p:ajax event="rowSelect" update="@form"/>
		            <p:ajax event="rowUnselect" update="@form"/>
		            <p:ajax event="rowSelectCheckbox" update="@form"/>
		            <p:ajax event="rowUnselectCheckbox" update="@form"/>
		            <p:ajax event="toggleSelect" update="@form"/>
            
            		<p:column selectionMode="multiple" exportable="false"></p:column>
            		
            		<p:column headerText="Nombre" sortBy="#{proyecto.nombre}">
		                <h:outputText value="#{proyecto.nombre}"/>
		            </p:column>
		            
		            <p:column headerText="DescripciÃ³n" sortBy="#{proyecto.descripcion}">
		                <h:outputText value="#{proyecto.descripcion}"/>
		            </p:column>
		            
		            <p:column headerText="Fecha de inicio" sortBy="#{proyecto.fechaInicio}">
		                <h:outputText value="#{proyecto.fechaInicio}">
						  <f:convertDateTime type="date" pattern="dd-MM-yyyy"/>
						</h:outputText>
		            </p:column>
		            
		            <p:column headerText="Acciones">
		                <p:commandButton icon="fa fa-pencil" update="@form"
		                                 oncomplete="PF('editarProyectoDialog').show()"
		                                 styleClass="edit-button rounded-button ui-button-success" process="@this">
		                    <f:setPropertyActionListener value="#{proyecto}" target="#{proyectoController.proyectoSelec}"/>
		                    <p:resetInput target=":form:manage-proyecto-content"/>
		                </p:commandButton>
		            </p:column>
            
                </p:dataTable>
                
                <p:toolbar>
		            <p:toolbarGroup align="right">
		                <p:commandButton value="New" icon="fa fa-plus" actionListener="#{proyectoController.nuevoProyecto}"
		                                 update="@form" oncomplete="PF('editarProyectoDialog').show()"
		                                 styleClass="ui-button-success" style="margin-right: .5rem">
		                    <p:resetInput target=":form:editarProyectoDialog"/>
		                </p:commandButton>  
		            </p:toolbarGroup>
		        </p:toolbar>
                
                </p:panelGrid>
                
                
                <p:dialog id="editarProyectoDialog" header="Detalles del proyecto" showEffect="fade" modal="true"
                  widgetVar="editarProyectoDialog" responsive="true">
                  
                  <p:outputPanel id="manage-proyecto-content" class="ui-fluid">
		                <p:outputPanel rendered="#{not empty proyectoController.proyectoSelec}">
		                    <div class="p-field">
		                        <p:outputLabel for="nombre">Nombre</p:outputLabel>
		                        <p:inputText id="nombre" value="#{proyectoController.proyectoSelec.nombre}" required="true"/>
		                    </div>
		                    <div class="p-field">
		                        <p:outputLabel for="descripcion">Descripcion</p:outputLabel>
		                        <p:inputTextarea id="descripcion" value="#{proyectoController.proyectoSelec.descripcion}"/>
		                    </div>
		                    <div class="p-field">
		                    	<p:outputLabel for="fecIni">Fecha de inicio</p:outputLabel>
		                        <p:datePicker id="fecIni" value="#{proyectoController.proyectoSelec.fechaInicio}"/>
		                    </div>
		                    
		                </p:outputPanel>
		            </p:outputPanel>
		            
		             <f:facet name="footer">
		                <p:commandButton value="Guardar" icon="fa fa-check" actionListener="#{proyectoController.guardarProyecto}"
		                                 update="manage-proyecto-content" process="manage-proyecto-content @this"/>
                        <p:commandButton value="Eliminar" icon="fa fa-check" actionListener="#{proyectoController.eliminarProyecto}"
                        				update="manage-proyecto-content" process="manage-proyecto-content @this"/>
		                <p:commandButton value="Cancelar" icon="fa fa-times" onclick="PF('editarProyectoDialog').hide()"
		                                 class="ui-button-secondary"/>
		            </f:facet>
	            </p:dialog>

        </h:form>
    </ui:define>

</ui:composition>